<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Daily Tech Digest</title>
        <style>
            :root {
                --sidebar-width: 350px;
                --primary-color: #4a90e2;
                --bg-color: #f4f7f6;
            }

            body,
            html {
                margin: 0;
                padding: 0;
                height: 100%;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                overflow: hidden;
            }

            .main-container {
                display: flex;
                height: 100vh;
            }

            /* å·¦ä¾§æ—¥å†æ  */
            .sidebar {
                width: var(--sidebar-width);
                background-color: white;
                border-right: 1px solid #ddd;
                display: flex;
                flex-direction: column;
                padding: 20px;
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.05);
                z-index: 10;
            }

            /* å³ä¾§å†…å®¹åŒº */
            .content-area {
                flex: 1;
                background-color: var(--bg-color);
                position: relative;
            }

            #content-frame {
                width: 100%;
                height: 100%;
                border: none;
                display: block;
            }

            /* æ—¥å†æ ·å¼ */
            .calendar-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }

            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 5px;
                text-align: center;
            }

            .weekday {
                font-weight: bold;
                color: #999;
                font-size: 0.8em;
                padding-bottom: 10px;
            }

            .day {
                padding: 10px 0;
                cursor: pointer;
                border-radius: 4px;
                transition: all 0.2s;
                font-size: 0.9em;
            }

            .day:hover {
                background-color: #e1f0ff;
            }

            .day.active {
                background-color: var(--primary-color) !important;
                color: white;
                font-weight: bold;
            }

            .day.today {
                border: 1px solid var(--primary-color);
                color: #ea4c89;
            }

            .day.empty {
                cursor: default;
            }

            .btn {
                background: none;
                border: 1px solid #ddd;
                padding: 5px 10px;
                cursor: pointer;
                border-radius: 4px;
            }

            .btn:hover {
                background-color: #f0f0f0;
            }

            .current-month-display {
                font-weight: bold;
                font-size: 1.1em;
            }

            /* éšè—æŒ‰é’®ç½®äºæ—¥å†ä¸‹æ–¹ï¼Œæ ·å¼ä¿æŒä½è°ƒ */
            .hide-action {
                margin-top: 12px;
                display: flex;
                justify-content: center;
            }

            .hide-btn {
                border: none;
                color: #666;
                padding: 6px 30px;
                border-radius: 18px;
                cursor: pointer;
                font-size: 0.95em;
            }

            .hide-btn:hover {
                background-color: #f5f8f8;
                color: var(--primary-color);
            }

            .hide-btn:focus {
                outline: 2px solid rgba(74, 144, 226, 0.2);
            }

            /* n8n é¡¹ç›®ç®€ä»‹ï¼ˆæ ·å¼ä¼˜åŒ–ï¼‰ */
            .n8n-info {
                background-color: #fbfcfc;
                border: 1px solid #e6e7e8;
                color: #2b2b2b;
                padding: 12px;
                margin-top: 12px;
                border-radius: 8px;
                font-size: 0.92em;
                line-height: 1.4;
                display: flex;
                gap: 10px;
                align-items: flex-start;
            }

            .n8n-info .icon {
                font-size: 1.3em;
                line-height: 1;
                margin-top: 2px;
            }

            .n8n-info .title {
                font-weight: 600;
                margin-bottom: 6px;
            }

            .n8n-info .content {
                min-width: 0;
            }

            .n8n-info ul {
                margin: 0;
                padding-left: 18px;
                color: #555;
            }

            .n8n-info .meta {
                margin-top: 8px;
                font-size: 0.85em;
                color: #666;
            }

            .n8n-info .actions {
                margin-top: 10px;
            }

            .download-btn {
                display: inline-block;
                background-image: linear-gradient(90deg, #FFD54F 0%, #FF8A00 55%, #FF3B30 100%);
                color: #fff;
                padding: 6px 10px;
                border-radius: 6px;
                text-decoration: none;
                font-size: 0.9em;
                border: 2px solid #FFD54F;
                /* é»„è‰²è¾¹æ¡† */
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
                transition: transform 140ms ease, box-shadow 140ms ease, filter 140ms ease;
            }

            .download-btn:hover {
                transform: translateY(-2px);
                filter: brightness(0.98);
                box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
            }

            .download-btn:focus {
                outline: 3px solid rgba(255, 213, 79, 0.25);
                outline-offset: 2px;
            }

            .n8n-info a {
                color: var(--primary-color);
                text-decoration: none;
                font-weight: 500;
            }

            .n8n-info a:hover {
                text-decoration: underline;
            }


            /* éšè—/æ˜¾ç¤ºä¾§è¾¹æ æ ·å¼ */
            .toggle-btn {
                padding: 5px 8px;
                font-size: 0.9em;
            }

            .sidebar {
                transition: all 0.3s ease;
                flex: 0 0 var(--sidebar-width);
            }

            .sidebar.collapsed {
                transform: translateX(-100%);
                flex: 0 0 0;
                padding: 0 0;
                border-right: none;
                overflow: hidden;
                pointer-events: none;
                /* avoid overlaying reveal tab when off-screen */
            }

            /* éšè—ä¾§è¾¹æ æ—¶åŒæ—¶éšè— n8n ä¿¡æ¯å— */
            .sidebar.collapsed .n8n-info {
                display: none;
            }

            .reveal-tab {
                position: fixed;
                /* fixed to ensure it's always clickable above iframe */
                left: 8px;
                top: 50%;
                transform: translateY(-50%);
                z-index: 9999;
                /* very high to be above iframe */
                border: 1px solid #ddd;
                background: #cdcbcb;
                width: 28px;
                height: 48px;
                display: none;
                align-items: center;
                justify-content: center;
                padding: 0;
                border-radius: 0 8px 8px 0;
                cursor: pointer;
                box-shadow: 2px 0 8px rgba(0, 0, 0, 0.12);
                font-size: 18px;
                -webkit-tap-highlight-color: transparent;
            }

            .reveal-tab.visible {
                display: flex;
            }

            .reveal-tab:hover {
                background: #fafafa;
            }

            .reveal-tab:focus {
                outline: 2px solid var(--primary-color);
            }

            /* ensure reveal tab is not obstructed on small screens */
            @media (max-width: 700px) {
                .reveal-tab {
                    left: 8px;
                }
            }

            .toast {
                position: fixed;
                left: 50%;
                bottom: 24px;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.75);
                color: #fff;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 0.9em;
                z-index: 100;
            }

            .toast.hidden {
                display: none;
            }

            /* ç§»åŠ¨ç«¯ï¼šåˆå§‹ä½œä¸ºç»å¯¹å±‚æ‚¬æµ®ï¼Œæ–¹ä¾¿æ»‘å‡ºéšè— */
            @media (max-width: 700px) {
                .sidebar {
                    position: absolute;
                    left: 0;
                    top: 0;
                    height: 100%;
                    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.08);
                }
            }
        </style>
    </head>

    <body>

        <div class="main-container">
            <!-- å·¦ä¾§æ—¥å† -->
            <div class="sidebar" id="sidebar" tabindex="-1">
                <div class="calendar-header">
                    <button class="btn" onclick="changeMonth(-1)">&lt;</button>
                    <div class="current-month-display" id="monthDisplay"></div>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <button class="btn" onclick="changeMonth(1)">&gt;</button>
                    </div>
                </div>

                <div class="calendar-grid" id="calendarGrid">
                    <!-- æ˜ŸæœŸè¡¨å¤´ -->
                    <div class="weekday">æ—¥</div>
                    <div class="weekday">ä¸€</div>
                    <div class="weekday">äºŒ</div>
                    <div class="weekday">ä¸‰</div>
                    <div class="weekday">å››</div>
                    <div class="weekday">äº”</div>
                    <div class="weekday">å…­</div>
                    <!-- æ—¥æœŸå°†ç”±JSç”Ÿæˆ -->
                </div>

                <div class="hide-action">
                    <button id="toggleSidebarBtn" class="hide-btn" onclick="toggleSidebar()" title="éšè—ä¾§è¾¹æ " aria-controls="sidebar" aria-expanded="true" aria-label="éšè—ä¾§è¾¹æ ">éšè—ä¾§è¾¹</button>
                </div>

                <div class="n8n-info" role="region" aria-label="n8n é¡¹ç›®ç®€ä»‹">
                    <div class="icon" aria-hidden="true">ğŸ¤–</div>
                    <div class="content">
                        <div class="title">RSSç§‘æŠ€æ—¥æŠ¥è‡ªåŠ¨å‘å¸ƒåˆ°GitHub</div>
                        <ul>
                            <li>å®šæ—¶æŠ“å– RSS å¹¶æ±‡æ€»ç”Ÿæˆå†…å®¹</li>
                            <li>ä½¿ç”¨ AI æ¸²æŸ“ä¸ºé™æ€ HTML é¡µé¢</li>
                            <li>è‡ªåŠ¨æ¨é€è‡³ GitHub å‘å¸ƒ</li>
                        </ul>
                        <div class="meta">å¯é…ç½®æ•°æ®æºã€å‘å¸ƒæ—¶é—´ä¸æ¨¡æ¿ï¼Œä½¿ç”¨ <a href="https://n8n.io" target="_blank" rel="noopener">n8n</a> ç®¡ç†å¹¶éƒ¨ç½²å·¥ä½œæµã€‚</div>
                        <div class="actions">
                            <a class="download-btn" href="https://ghp.yanel.me/https://raw.githubusercontent.com/Yanel85/Daily-Tech-Digest/refs/heads/main/RSS%E7%A7%91%E6%8A%80%E6%97%A5%E6%8A%A5%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83%E5%88%B0GitHub.json?download=true" download="n8n-workflow.json" aria-label="ä¸‹è½½ n8n å·¥ä½œæµ" target="_blank">ä¸‹è½½n8nå·¥ä½œæµ</a>
                        </div>
                    </div>
                </div>

            </div>

            <!-- å³ä¾§æ˜¾ç¤ºåŒºåŸŸ -->
            <div class="content-area">
                <button id="revealTab" class="reveal-tab" aria-label="å±•å¼€ä¾§è¾¹æ " title="å±•å¼€ä¾§è¾¹æ " aria-controls="sidebar" tabindex="0">â˜°</button>
                <iframe id="content-frame" name="content-frame" src=""></iframe>
                <div id="toast" class="toast hidden" role="status" aria-live="polite"></div>
            </div>
        </div>

        <script>
            let currentDate = new Date(); // å½“å‰æ˜¾ç¤ºçš„æœˆä»½
            const today = new Date();     // ä»Šå¤©çš„å®é™…æ—¥æœŸ

            const monthDisplay = document.getElementById('monthDisplay');
            const calendarGrid = document.getElementById('calendarGrid');
            const contentFrame = document.getElementById('content-frame');
            const currentPathDisplay = document.getElementById('currentPathDisplay');


            // åˆå§‹åŒ–æ—¥å†
            function initCalendar() {
                renderCalendar();
                // é»˜è®¤åŠ è½½ä»Šå¤©çš„é¡µé¢
                loadPage(today.getFullYear(), today.getMonth() + 1, today.getDate());
            }

            function renderCalendar() {
                // æ¸…é™¤æ—§çš„æ—¥æœŸï¼ˆä¿ç•™æ˜ŸæœŸè¡¨å¤´ï¼‰
                const weekdays = document.querySelectorAll('.weekday');
                calendarGrid.innerHTML = '';
                weekdays.forEach(day => calendarGrid.appendChild(day));

                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();

                monthDisplay.innerText = `${year}å¹´ ${month + 1}æœˆ`;

                // è·å–å½“æœˆç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ 
                const firstDay = new Date(year, month, 1).getDay();
                // è·å–å½“æœˆæœ€åä¸€å¤©
                const lastDate = new Date(year, month + 1, 0).getDate();

                // å¡«å……ç©ºç™½æ—¥æœŸ
                for (let i = 0; i < firstDay; i++) {
                    const emptyDiv = document.createElement('div');
                    emptyDiv.classList.add('day', 'empty');
                    calendarGrid.appendChild(emptyDiv);
                }

                // å¡«å……å®é™…æ—¥æœŸ
                for (let i = 1; i <= lastDate; i++) {
                    const dayDiv = document.createElement('div');
                    dayDiv.classList.add('day');
                    dayDiv.innerText = i;

                    // æ ‡è®°ä»Šå¤©
                    if (year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {
                        dayDiv.classList.add('today');
                    }

                    // ç‚¹å‡»äº‹ä»¶
                    dayDiv.onclick = () => {
                        // ç§»é™¤å…¶ä»–æ¿€æ´»çŠ¶æ€
                        document.querySelectorAll('.day').forEach(d => d.classList.remove('active'));
                        dayDiv.classList.add('active');
                        loadPage(year, month + 1, i);
                    };

                    calendarGrid.appendChild(dayDiv);
                }
            }

            function loadPage(year, month, day) {
                // æ ¼å¼åŒ–æ—¥æœŸï¼šæœˆä»½å’Œæ—¥æœŸè¡¥é›¶ (ä¾‹å¦‚: 2023/05/09.html)
                // const fMonth = month.toString().padStart(2, '0');
                //const fDay = day.toString().padStart(2, '0');

                // æ„é€ è·¯å¾„
                const path = `${year}/${month}/${day}.html`;

                // æ›´æ–° iframe åœ°å€
                contentFrame.src = path;


                // é”™è¯¯å¤„ç† (å½“æ–‡ä»¶ä¸å­˜åœ¨æ—¶)
                contentFrame.onerror = function () {
                    console.error("æ— æ³•åŠ è½½é¡µé¢: " + path);
                };
            }

            function changeMonth(offset) {
                currentDate.setMonth(currentDate.getMonth() + offset);
                renderCalendar();
            }

            const sidebar = document.querySelector('.sidebar');
            const toggleBtn = document.getElementById('toggleSidebarBtn');
            const revealTab = document.getElementById('revealTab');
            const toast = document.getElementById('toast');

            let tempExpandedByHover = false;
            // å½“ç”¨æˆ·æ‰‹åŠ¨åˆ‡æ¢è¿‡ä¸€æ¬¡åï¼Œé¿å…è‡ªåŠ¨å“åº”å¼è¦†ç›–ä»–ä»¬çš„åå¥½
            let userToggled = false;

            function setToggleButtonLabel(expanded) {
                if (!toggleBtn) return;
                toggleBtn.innerText = expanded ? 'éšè—ä¾§è¾¹' : 'æ˜¾ç¤ºä¾§è¾¹';
                toggleBtn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
                toggleBtn.setAttribute('title', expanded ? 'ç‚¹å‡»éšè—ä¾§è¾¹æ ' : 'ç‚¹å‡»æ˜¾ç¤ºä¾§è¾¹æ ');
            }

            // åˆ‡æ¢ä¾§è¾¹æ ï¼štrue = æŠ˜å , false = å±•å¼€
            function toggleSidebar(forceState) {
                if (!sidebar) return;
                let shouldCollapse;
                if (typeof forceState === 'boolean') shouldCollapse = forceState;
                else shouldCollapse = !sidebar.classList.contains('collapsed');

                if (shouldCollapse) {
                    sidebar.classList.add('collapsed');
                    setToggleButtonLabel(false);
                    if (revealTab) revealTab.classList.add('visible');
                    sidebar.setAttribute('aria-hidden', 'true');
                } else {
                    sidebar.classList.remove('collapsed');
                    setToggleButtonLabel(true);
                    if (revealTab) revealTab.classList.remove('visible');
                    sidebar.setAttribute('aria-hidden', 'false');
                }

                // æ ‡è®°ä¸ºç”¨æˆ·ä¸»åŠ¨æ“ä½œï¼ˆå¦‚æœæ²¡æœ‰ä¼ å‚æ•°åˆ™è§†ä¸ºç”¨æˆ·ç‚¹å‡»ï¼‰ï¼Œç”¨äºå“åº”å¼å†³ç­–
                if (typeof forceState === 'undefined') userToggled = true;
            }

            if (revealTab) {
                // ç‚¹å‡»/è§¦æ‘¸å±•å¼€
                revealTab.addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); toggleSidebar(false); userToggled = true; if (sidebar) sidebar.focus(); });
                revealTab.addEventListener('touchstart', (e) => { e.preventDefault(); e.stopPropagation(); toggleSidebar(false); userToggled = true; if (sidebar) sidebar.focus(); }, { passive: false });


                // é”®ç›˜æ”¯æŒï¼ˆEnter/Space æ¿€æ´»ï¼‰
                revealTab.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleSidebar(false);
                    }
                });
            }

            // ç®€å•æç¤ºæ¡†
            function showToast(message, duration = 3000) {
                if (!toast) return;
                toast.innerText = message;
                toast.classList.remove('hidden');
                clearTimeout(showToast._t);
                showToast._t = setTimeout(() => toast.classList.add('hidden'), duration);
            }

            // å“åº”å¼å¤„ç†ï¼šç§»åŠ¨ç«¯è‡ªåŠ¨éšè—
            function handleResponsive() {
                if (window.innerWidth <= 700) {
                    toggleSidebar(true);
                    showToast('å±å¹•è¾ƒå°ï¼Œä¾§è¾¹æ å·²éšè—ï¼Œç‚¹å‡» â˜° å±•å¼€');
                } else {
                    // å¦‚æœç”¨æˆ·æ²¡æœ‰æ‰‹åŠ¨åˆ‡æ¢è¿‡ï¼Œæˆ‘ä»¬åœ¨å¤§å±ä¸Šä¿æŒå±•å¼€
                    if (!userToggled) toggleSidebar(false);
                }
            }

            window.addEventListener('resize', () => handleResponsive());

            // å¯åŠ¨
            function initCalendar() {
                renderCalendar();
                // é»˜è®¤åŠ è½½ä»Šå¤©çš„é¡µé¢
                loadPage(today.getFullYear(), today.getMonth() + 1, today.getDate());
                // åˆå§‹åŒ–æŒ‰é’®çŠ¶æ€
                setToggleButtonLabel(true);
                // å¯åŠ¨æ—¶æ£€æŸ¥å“åº”å¼
                handleResponsive();
            }

            initCalendar();
        </script>

    </body>

</html>